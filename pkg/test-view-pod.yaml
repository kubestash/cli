apiVersion: v1
kind: Pod
metadata:
  name: test-view-pod
  namespace: demo
spec:
  containers:
    - name: kubestash
      image: ghcr.io/kubestash/kubestash:v0.18.0
      command: [ "sleep", "3600" ]
      volumeMounts:
        - name: snapshot-dir
          mountPath: /kubestash-tmp
  volumes:
    - name: snapshot-dir
      emptyDir: {}
---
apiVersion: rbac.authorization.k8s.io/v1
kind: Role
metadata:
  name: kubestash-snapshot-reader
  namespace: demo
rules:
  - apiGroups: [ "storage.kubestash.com" ]
    resources: [ "snapshots", "repositories", "backupstorages" ]
    verbs: ["get", "list", "watch"]
---
apiVersion: rbac.authorization.k8s.io/v1
kind: RoleBinding
metadata:
  name: kubestash-snapshot-reader-binding
  namespace: demo
subjects:
  - kind: ServiceAccount
    name: default
    namespace: demo
roleRef:
  kind: Role
  name: kubestash-snapshot-reader
  apiGroup: rbac.authorization.k8s.io

